<p>在动态点分治的过程中，一个结点在其点分树上的祖先结点的信息中可能会被重复计算，这是我们需要消去重复部分的影响。一般的方法是对于一个连通块用两种方式记录：一个是其到分治中心的距离信息，另一个是其到点分树上分治中心父亲的距离信息。这一部分内容将在例题中得到展现。</p>
<details class="note"><summary>" 例题<a href="https://www.luogu.com.cn/problem/P2056">「ZJOI2007」捉迷藏</a>"</summary><p>给定一棵有 $n$ 个结点的树，初始时所有结点都是黑色的。你需要实现以下两种操作：</p><ol>
<li>
<p>反转一个结点的颜色（白变黑，黑变白）；</p>
</li>
<li>
<p>询问树上两个最远的黑点的距离。</p>
<p>$n\le 10^5,m\le 5\times 10^5$</p>
</li>
</ol></details>
<p>求出点分树，对于每个结点 $x$ 维护两个 <strong>可删堆</strong>。$dist[x]$ 存储结点 $x$ 代表的连通块中的所有黑点到 $x$ 的距离信息，$ch[x]$ 表示结点 $x$ 在点分树上的所有儿子和它自己中的黑点到 $x$ 的距离信息，由于本题贪心的求答案方法，且两个来自于同一子树的路径不能成为一条完成的路径，我们只在这个堆中插入其自己的值和其每个子树中的最大值。我们发现，$ch[x]$ 中最大的两个值（如果没有两个就是所有值）的和就是分治时分支中心为 $x$ 时经过结点 $x$ 的最长黑端点路径。我们可以用可删堆 $ans$ 存储所有结点的答案，这个堆中的最大值就是我们所求的答案。</p>
